---
import Layout from "../layouts/Layout.astro";
// import { Blazor } from "../../../../Nodsoft.MoltenObsidian.WasmContainer/bin/Release/net8.0/wwwroot/_framework/blazor.webassembly.js";
import type { VaultManifest } from "moltenobsidian-ssg-client/vault-manifest";
import { VaultManifestClient } from "moltenobsidian-ssg-client/manifest-client";

export const vaultBaseUri = "http://localhost:8089/";
export const vaultManifestUri = vaultBaseUri + "moltenobsidian.manifest.json";

export async function getStaticPaths() {
  const manifest: VaultManifest = await (await fetch(vaultManifestUri, { mode: "no-cors" })).json();
  const paths = []

  const manifestClient = new VaultManifestClient(manifest)

  for (const [navPath, {remotePath}] of manifestClient.routingTable) {
    paths.push({params: {path: navPath === '' ? undefined : navPath}, props: {remotePath}});
  }

  return paths;
}

const {path} = Astro.params;
const {content, cssclasses} = Astro.props;
---
<Layout>
	<article
		style="margin-top: 4rem; margin-bottom: 4rem;" 
    class="moltenobsidian-content" 
    class:list={cssclasses} 
    data-test="Test"
	>
		<Fragment set:html={content} />
	</article>
</Layout>